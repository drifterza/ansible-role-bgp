---
# Copyright 2019, Internet Solutions.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

bird_package_state: latest

bird_conf_dir: /etc/bird

bird_router_id: "{{ ansible_default_ipv4['address'] }}" 

# Force an update of the network facts before building the configuration
# This is useful when protocol auto detection is used, because the network may
# have changed since facts were last gathered if they have been cached a while.
bird_gather_net_facts: true

# Auto-enable bird/bird6 if an ipv4/ipv6 default route is present
# Set to true/false to override auto detection
bird_ipv4_enabled: detect
bird_ipv6_enabled: detect

bird_syslog_location: "/var/log/bird.log"

bird_configs:
  - config_file: "{{ bird_conf_dir }}/bird.conf"
    enabled: "{{ bird_ipv4_enabled }}"
    service: bird
    includes: "{{ bird_ipv4_includes }}"
    protocols: "{{ bird_ipv4_protocols }}"
  - config_file: "{{ bird_conf_dir }}/bird6.conf"
    enabled: "{{ bird_ipv6_enabled }}"
    service: bird6
    includes: "{{ bird_ipv6_includes }}"
    protocols: "{{ bird_ipv6_protocols }}"

bird_ipv4_includes: 
  - bird_bgp_1.conf
  - bird_bgp_2.conf
  - ipv4_filters.conf
  - ipv4_static.conf

bird_ipv4_protocols: "{{ bird_default_protocols }}"
bird_ipv6_includes: []
bird_ipv6_filters: {}
bird_ipv6_protocols: "{{ bird_default_protocols }}"

bird_local_as_1: "65000"
bird_neighbor_address_1: "127.0.0.1"
bird_cidr_1: "127.0.0.0/20"
bird_neighbor_as_1: "65000"
bird_bgp_description_1: "I am a Bird"
bird_static_gateway_1: '"eth0"' # Needs to be a quoted string
bird_static_gateway_2: "127.0.0.1" #Needs to be none quoted string

bird_local_as_2: "65002"
bird_neighbor_address_2: "127.0.0.1"
bird_cidr_2: "127.0.0.0/20"
bird_neighbor_as_2: "65000"
bird_bgp_description_2: "I am a Bird number 2"

bird_protocols_direct_device: "eth*"

bird_default_protocols:
  kernel: "{{ bird_protocols_kernel }}"
  device: "{{ bird_protocols_device }}"

bird_protocols_device: |
  scan time 10;

bird_protocols_kernel: |
  scan time 2;
  learn;
  device routes;
  export all;
  import filter default_gw_filter;