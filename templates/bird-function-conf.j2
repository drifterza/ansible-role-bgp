# {{ ansible_managed }}

function is_self_net() 
{
  return net ~ {{ bird_ipv4_cidr }};
}

function avoid_crappy_prefixes()
{
  if net.len < 8 then return false;
  if net.len > 24 then return false;
  if bgp_path.len > 64 then return false; 
  return true;
}

function is_valid_network_v6() 
{
  return net ~ [
    fd00::/8{44,64} # ULA address space as per RFC 4193
  ];
}

function is_self_net_v6() 
{
  return net ~ {{ bird_ipv6_cidr }};
}

function net_martians_v4()
{
    return net ~ [ 10.0.0.0/8+, 172.16.0.0/12+, 192.168.0.0/16+,
                   0.0.0.0/0, 0.0.0.0/8+, 100.64.0.0/10+, 127.0.0.0/8+,
                   169.254.0.0/16+, 192.0.0.0/24+, 192.0.2.0/24+,
                   198.18.0.0/15+, 198.51.100.0/24+, 203.0.113.0/24+,
                   224.0.0.0/3+,
                   0.0.0.0/0{25,32} ];
}

function net_martians_v6()
{
    return net ~ [ ::/0, 2001::/32{33,128}, 2001:10::/28+, 2001:db8::/32+,
                   2002::/16{17,128} ];
}

function is_valid_network() 
{
  return net ~ [
    168.210.2.2/32, # dnscache1.is.co.za Anycast
    196.14.239.2/32 # dnscache2.is.co.za Anycast
  ];
}