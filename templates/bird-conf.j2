# {{ ansible_managed }}

log syslog { info, remote, warning, error, auth, fatal, bug };
log "{{ bird_syslog_location }}" { debug, remote, trace };

router id {{ bird_router_id }};

include "/etc/bird/functions.conf";
include "/etc/bird/filters.conf";


protocol device {
    scan time 10;
}

roa4 table is_roa_v4;
roa6 table is_roa_v6;

protocol static {
    roa4 { table is_roa_v4; };
    include "/etc/bird/roa_is_v4.conf";
};

protocol static {
    roa6 { table is_roa_v6; };
    include "/etc/bird/roa_is_v6.conf";
};

{% if bird_ipv4_enabled is defined %}
protocol kernel {
    scan time 20;

    ipv4 {
        import filter default_gw_filter;
        export filter kernel_export_ipv4;
    };
}
{% endif %}

{% if bird_ipv6_enabled is defined %}
protocol kernel {
    scan time 20;
    
    ipv6 {
        import filter default_gw_filter;
        export filter kernel_export_ipv6;
    };
}
{% endif %}

include "/etc/bird/peers/*.conf";